"use strict";(self.webpackChunkcomments_app=self.webpackChunkcomments_app||[]).push([[373],{373:(M,C,s)=>{s.r(C),s.d(C,{CommentsModule:()=>J});var u=s(6895),f=s(6773),t=s(8256),p=s(2340),_=s(529);let g=(()=>{class n{constructor(e){this.http=e}getComments(){return this.http.get(`${p.N.baseUrl}/comments`)}postComment(e){return this.http.post(`${p.N.baseUrl}/comments`,e)}deleteComment(e){return this.http.delete(`${p.N.baseUrl}/comments/${e}`)}updateComment(e){return this.http.put(`${p.N.baseUrl}/comments/${e.id}`,e)}replyComment(e){return this.http.post(`${p.N.baseUrl}/comments/${e.id}/reply`,{...e})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var c=s(433);const h=function(n){return{"validation-error":n}};let v=(()=>{class n{constructor(e,m){this.fb=e,this.apiService=m,this.formEmit=new t.vpe,this.btnText="Submit",this.commentForm=this.fb.group({id:[""],name:["",c.kI.required],comment:["",c.kI.required],type:["comment"]})}ngOnChanges(){this.commentForm.patchValue({id:this.comment?.id||"",name:this.comment?.name||"",comment:this.comment?.comment_text||"",type:this.comment?.type||"comment"})}ngOnInit(){}getHeading(){return"reply"==this.commentForm.get("type")?.value?`Reply to ${this.comment.comment?.name}`:(this.commentForm.get("id")?.value?"Update":"Post")+" Comment"}onSubmit(){const{id:e,type:m}=this.commentForm.value;"comment"==m?e?this.updateComment():this.postComment():this.postReply()}onClickCancel(){this.commentForm.reset(),this.commentForm.patchValue({id:"",name:"",comment:"",type:"comment"})}postComment(){this.apiService.postComment(this.commentForm.value).subscribe(e=>{this.formEmit.emit({reload:!0}),this.onClickCancel()})}updateComment(){this.apiService.updateComment(this.commentForm.value).subscribe(e=>{this.formEmit.emit({reload:!0}),this.onClickCancel()})}postReply(){this.apiService.replyComment(this.commentForm.value).subscribe(e=>{this.formEmit.emit({reload:!0}),this.onClickCancel()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.qu),t.Y36(g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comment-form"]],inputs:{comment:"comment"},outputs:{formEmit:"formEmit"},features:[t.TTD],decls:18,vars:10,consts:[[1,"card"],[1,"p-3"],[1,"p-3",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","userName",1,"form-label"],["type","text","id","userName","formControlName","name",1,"form-control",3,"ngClass"],["for","commentText",1,"form-label"],["id","commentText","rows","20","formControlName","comment",1,"form-control",3,"ngClass"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn=lg","btn-primary",3,"disabled"],["type","button",1,"btn","btn=lg","btn-primary",3,"click"]],template:function(e,m){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h6"),t._uU(3),t.qZA()(),t.TgZ(4,"form",2),t.NdJ("ngSubmit",function(){return m.onSubmit()}),t.TgZ(5,"div",3)(6,"label",4),t._uU(7,"Name *"),t.qZA(),t._UZ(8,"input",5),t.qZA(),t.TgZ(9,"div",3)(10,"label",6),t._uU(11,"Comment *"),t.qZA(),t._UZ(12,"textarea",7),t.qZA(),t.TgZ(13,"div",8)(14,"button",9),t._uU(15),t.qZA(),t.TgZ(16,"button",10),t.NdJ("click",function(){return m.onClickCancel()}),t._uU(17,"Cancel"),t.qZA()()()()),2&e){let r,i;t.xp6(3),t.Oqu(m.getHeading()),t.xp6(1),t.Q6J("formGroup",m.commentForm),t.xp6(4),t.Q6J("ngClass",t.VKq(6,h,(null==(r=m.commentForm.get("name"))?null:r.invalid)&&((null==(r=m.commentForm.get("name"))?null:r.dirty)||(null==(r=m.commentForm.get("name"))?null:r.touched)))),t.xp6(4),t.Q6J("ngClass",t.VKq(8,h,(null==(i=m.commentForm.get("comment"))?null:i.invalid)&&((null==(i=m.commentForm.get("comment"))?null:i.dirty)||(null==(i=m.commentForm.get("comment"))?null:i.touched)))),t.xp6(2),t.Q6J("disabled",!m.commentForm.valid),t.xp6(1),t.Oqu(m.btnText)}},dependencies:[u.mk,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u]}),n})(),y=(()=>{class n{transform(e,m){const r=new Date(e).getTimezoneOffset();if(console.log(new Date),console.log(new Date(e)),console.log(r),e){const i=Math.floor((+new Date-+new Date(e))/1e3);if(i<29)return"Just now";const l={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};let a;for(const d in l)if(a=Math.floor(i/l[d]),a>0)return 1===a?a+" "+d+" ago":a+" "+d+"s ago"}return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"timeDuration",type:n,pure:!0}),n})();function Z(n,o){1&n&&(t.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"span"),t._uU(4,"No Comments Found"),t.qZA()()()())}function T(n,o){if(1&n&&(t.TgZ(0,"div",16)(1,"div",7)(2,"div",8)(3,"span",9),t._uU(4),t.qZA()(),t.TgZ(5,"small",10),t._uU(6),t.ALo(7,"timeDuration"),t.qZA()(),t._UZ(8,"p",11),t.qZA()),2&n){const e=o.$implicit;t.xp6(4),t.Oqu(e.name),t.xp6(2),t.Oqu(t.lcZ(7,3,e.reply_on)),t.xp6(2),t.Q6J("innerHTML",e.reply_text,t.oJD)}}function F(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"span",9),t._uU(6),t.qZA()(),t.TgZ(7,"small",10),t._uU(8),t.ALo(9,"timeDuration"),t.qZA()(),t._UZ(10,"p",11),t.TgZ(11,"div",12)(12,"a",13),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onClickEdit(i))}),t._uU(13,"Edit"),t.qZA(),t.TgZ(14,"a",13),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onClickDelete(i))}),t._uU(15,"Delete"),t.qZA(),t.TgZ(16,"a",13),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onClickReply(i))}),t._uU(17,"Reply"),t.qZA()(),t.TgZ(18,"div",14),t.YNc(19,T,9,5,"div",15),t.qZA()()()()}if(2&n){const e=o.$implicit;t.xp6(6),t.Oqu(e.name),t.xp6(2),t.Oqu(t.lcZ(9,4,e.comment_on)),t.xp6(2),t.Q6J("innerHTML",e.comment_text,t.oJD),t.xp6(9),t.Q6J("ngForOf",e.replies)}}let b=(()=>{class n{constructor(){this.comments=[],this.commentEvent=new t.vpe}ngOnInit(){}onClickEdit(e){this.commentEvent.emit({id:e.id,name:e.name,comment_text:e.comment_text,type:"comment",action:"edit",comment:e})}onClickDelete(e){confirm("Are you sure to delete ?")&&this.commentEvent.emit({id:e.id,name:e.name,comment_text:e.comment_text,type:"comment",action:"delete",comment:e})}onClickReply(e){this.commentEvent.emit({id:e.id,name:e.name,comment_text:e.comment_text,type:"reply",action:"post",comment:e})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comment-list"]],inputs:{comments:"comments"},outputs:{commentEvent:"commentEvent"},decls:6,vars:2,consts:[[1,"card"],[1,"p-3"],["class","mt-2",4,"ngIf"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"d-flex","flex-row","p-3"],[1,"w-100"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex","flex-row","align-items-center"],[1,"mr-2","user-title"],[1,"duration"],[1,"text-justify","comment-text","mb-0",3,"innerHTML"],[1,"d-flex","flex-row","user-feed"],["href","javascript:",3,"click"],[1,"comment-replies"],["class","reply",4,"ngFor","ngForOf"],[1,"reply"]],template:function(e,m){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h6"),t._uU(3,"Comments"),t.qZA()(),t.YNc(4,Z,5,0,"div",2),t.YNc(5,F,20,6,"div",3),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",!m.comments.length),t.xp6(1),t.Q6J("ngForOf",m.comments))},dependencies:[u.sg,u.O5,y],styles:[".comment-replies[_ngcontent-%COMP%]{width:90%;float:right}.comment-replies[_ngcontent-%COMP%] > .reply[_ngcontent-%COMP%]{padding:.5rem}"]}),n})();const x=[{path:"",component:(()=>{class n{constructor(e){this.apiService=e,this.comments=[]}ngOnInit(){this.getComments()}getComments(){this.apiService.getComments().subscribe(e=>this.comments=e)}onFormEmit(e){e.reload&&this.getComments()}onCommentEmit(e){"reply"==e.type?this.comment={id:e.id,name:"",comment_text:"",type:"reply",action:"post",comment:e.comment}:("edit"==e.action&&(this.comment=e),"delete"==e.action&&this.apiService.deleteComment(e.id).subscribe(m=>{this.getComments(),alert(m.message)}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-main"]],decls:6,vars:2,consts:[[1,"container","mt-5","mb-5"],[1,"row","height","d-flex"],[1,"col-md-6"],[3,"comment","formEmit"],[3,"comments","commentEvent"]],template:function(e,m){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-comment-form",3),t.NdJ("formEmit",function(i){return m.onFormEmit(i)}),t.qZA()(),t.TgZ(4,"div",2)(5,"app-comment-list",4),t.NdJ("commentEvent",function(i){return m.onCommentEmit(i)}),t.qZA()()()()),2&e&&(t.xp6(3),t.Q6J("comment",m.comment),t.xp6(2),t.Q6J("comments",m.comments))},dependencies:[v,b]}),n})(),title:"Comments"}];let A=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.Bz.forChild(x),f.Bz]}),n})();var E=s(5347);let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,A,E.m]}),n})()}}]);